<Page
    x:Class="NativeDiscord.Views.FriendsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:NativeDiscord.Models"
    mc:Ignorable="d">

    <Grid Background="{StaticResource DiscordBackgroundTertiary}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Column 0: DM Sidebar -->
        <Grid Grid.Column="0" Background="{StaticResource DiscordBackgroundSecondary}">
            <Grid.RowDefinitions>
                <RowDefinition Height="48"/> <!-- Search / Header -->
                <RowDefinition Height="*"/>    <!-- DM List -->
                <RowDefinition Height="Auto"/> <!-- User Footer -->
            </Grid.RowDefinitions>
            
            <!-- Search Bar Mock -->
            <Border BorderBrush="#111111" BorderThickness="0,0,0,1" Padding="12">
                 <Button Click="SearchButton_Click" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="#1E1F22" Foreground="#949BA4" Padding="6,4" CornerRadius="4" BorderThickness="0">
                     <TextBlock Text="Find or start a conversation" FontSize="12"/>
                 </Button>
            </Border>
            
            <!-- Sidebar Content -->
            <ScrollViewer Grid.Row="1" Padding="8,8,0,0">
                <StackPanel Spacing="2">
                    <!-- Friends Button (Active) -->
                    <Button Click="FriendsButton_Click" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="#3F4147" Foreground="White" Padding="12,8" CornerRadius="4" BorderThickness="0">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE716;" FontSize="16"/>
                            <TextBlock Text="Friends" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- Nitro (Quests) -->
                    <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="Transparent" Foreground="#949BA4" Padding="12,8" CornerRadius="4" BorderThickness="0">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE76E;" FontSize="16"/>
                            <TextBlock Text="Nitro" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                    
                    <!-- Shop -->
                    <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Background="Transparent" Foreground="#949BA4" Padding="12,8" CornerRadius="4" BorderThickness="0">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE719;" FontSize="16"/>
                            <TextBlock Text="Shop" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                    
                    <TextBlock Text="DIRECT MESSAGES" Foreground="#949BA4" FontSize="11" FontWeight="Bold" Margin="12,16,0,4"/>
                    
                    <!-- DM List -->
                    <ListView x:Name="DMList" ItemsSource="{x:Bind PrivateChannels}" SelectionMode="Single" SelectionChanged="DMList_SelectionChanged">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="8,8"/>
                                <Setter Property="Margin" Value="0,1"/>
                                <Setter Property="CornerRadius" Value="4"/>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="models:DMChannelViewModel">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                     <Grid Width="32" Height="32">
                                         <Ellipse>
                                             <Ellipse.Fill>
                                                 <ImageBrush ImageSource="{x:Bind IconUrl}" />
                                             </Ellipse.Fill>
                                         </Ellipse>
                                         <!-- Status Indicator (Mock) -->
                                         <Ellipse Width="10" Height="10" Fill="{x:Bind StatusColor, Mode=OneWay}" Stroke="#2B2D31" StrokeThickness="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="-2,-2"/> 
                                     </Grid>
                                     <StackPanel VerticalAlignment="Center">
                                         <TextBlock Text="{x:Bind Name}" Foreground="#DBDEE1" TextTrimming="CharacterEllipsis"/>
                                         <TextBlock Text="{x:Bind Subtitle}" Foreground="#949BA4" FontSize="11" TextTrimming="CharacterEllipsis" Visibility="{x:Bind SubtitleVisibility}"/>
                                     </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>
            </ScrollViewer>
            
            <!-- User Footer -->
            <Grid Grid.Row="2" Background="#232428" Padding="8">
                <!-- User Footer Content (Unchanged) -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Grid Width="32" Height="32" Margin="0,0,8,0">
                    <Ellipse>
                        <Ellipse.Fill>
                            <ImageBrush x:Name="CurrentUserAvatar"/>
                        </Ellipse.Fill>
                    </Ellipse>
                    <Ellipse Width="10" Height="10" Fill="#23A559" Stroke="#232428" StrokeThickness="2" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="-2,-2"/>
                </Grid>

                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock x:Name="CurrentUserDisplayName" Text="User" Style="{StaticResource BodyStrongTextBlockStyle}" FontSize="13" Foreground="{StaticResource DiscordTextNormal}" TextTrimming="CharacterEllipsis"/>
                    <TextBlock x:Name="CurrentUserUsername" Text="#0000" Style="{StaticResource CaptionTextBlockStyle}" Foreground="{StaticResource DiscordTextMuted}" FontSize="12" TextTrimming="CharacterEllipsis"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="0">
                     <!-- Mic -->
                     <Button Background="Transparent" BorderThickness="0" Padding="6" CornerRadius="4">
                        <FontIcon Glyph="&#xE720;" FontSize="16" Foreground="{StaticResource DiscordInteractiveNormal}"/>
                        <ToolTipService.ToolTip>Mute</ToolTipService.ToolTip>
                     </Button>
                     <!-- Deafen -->
                     <Button Background="Transparent" BorderThickness="0" Padding="6" CornerRadius="4">
                        <FontIcon Glyph="&#xE7F6;" FontSize="16" Foreground="{StaticResource DiscordInteractiveNormal}"/>
                        <ToolTipService.ToolTip>Deafen</ToolTipService.ToolTip>
                     </Button>
                     <!-- Settings -->
                     <Button Background="Transparent" BorderThickness="0" Padding="6" CornerRadius="4">
                        <FontIcon Glyph="&#xE713;" FontSize="16" Foreground="{StaticResource DiscordInteractiveNormal}"/>
                        <ToolTipService.ToolTip>User Settings</ToolTipService.ToolTip>
                     </Button>
                </StackPanel>
            </Grid>
        </Grid>
        
        <!-- Column 1: Main Content Frame -->
        <Frame Grid.Column="1" x:Name="HomeContentFrame" Background="{StaticResource DiscordBackgroundPrimary}"/>

    </Grid>
</Page>
